CREATE TABLE films (
  id SERIAL PRIMARY KEY,
  name VARCHAR (250) NOT NULL,
  country VARCHAR (60),
  fees MONEY,
  release_year TIMESTAMP -- для вывода date_part('year', release_year)
); 
  
CREATE TABLE persons (
  id SERIAL PRIMARY KEY,
  name VARCHAR (100) NOT NULL
);
 
CREATE TABLE person2content (
  person_id SERIAL,
  content_id SERIAL,
  person_role VARCHAR (60),
  PRIMARY KEY (person_id, content_id, person_role)
  FOREIGN KEY (person_id) REFERENCES persons(id),
  FOREIGN KEY (content_id) REFERENCES films(id)
);
 
INSERT INTO films VALUES (
  (1, 'Отличница лёгкого поведения', 'США', 74952305, to_timestamp('2010', 'YY'),
  (2, 'Дьявол носит Prada', 'США, Франция', 326260148, to_timestamp('2006', 'YY')),
  (3, 'Ван Хельсинг', 'США, Чехия', 300157638, to_timestamp('2004', 'YY')),
  (4, 'Дэдпул', 'США', 783112979, to_timestamp('2016', 'YY')),                                                       
  (5, 'Зеленая миля', 'США', 286801374, to_timestamp('1999', 'YY'))  
);

INSERT INTO persons VALUES (
  (1, 'Уилл Глак'),
  (2, 'Берт В. Ройал'),
  (3, 'Зэнн Дивайн'),
  (4, 'Уилл Глак'),
  (5, 'Алисия Эммрич'),
  (6, 'Майкл Грэйди'),
  (7, 'Брэд Сигал'),
  (8, 'Марсия Хиндс'),
  (9, 'Бо Джонсон'),
  (10, 'Сьюзэн Литтенберг'),
  (11, 'Эмма Стоун'),
  (12, 'Пенн Бэджли'),
  (13, 'Аманда Байнс'),
  (14, 'Дэн Берд'),
  (15, 'Дэвид Фрэнкел'),
  (16, 'Алин Брош МакКенна'),
  (17, 'Лорен Вайсбергер'),
  (18, 'Венди Файнерман'),
  (19, 'Джон Бернард'),
  (20, 'Флориан Баллхаус'),
  (21, 'Теодор Шапиро'),
  (22, 'Джесс Гончор'),
  (23, 'Марк Ливолси'),
  (24, 'Мэрил Стрип'),
  (25, 'Энн Хэтэуэй'),
  (26, 'Эмили Блант'),
  (27, 'Стэнли Туччи'),
  (28, 'Стивен Соммерс'),
  (29, 'Боб Дюксэй'),
  (28, 'Стивен Соммерс'),
  (30, 'Сэм Мерсер'),
  (31, 'Аллен Давио'),
  (32, 'Алан Сильвестри'),
  (33, 'Аллан Камерон'),
  (34, 'Келли Мацумото'),
  (35, 'Джим Мэй'),
  (36, 'Хью Джекман'),
  (37, 'Кейт Бекинсейл'),
  (38, 'Ричард Роксбург'),
  (39, 'Тим Миллер'),
  (40, 'Ретт Риз'),
  (41, 'Пол Верник'),
  (42, 'Саймон Кинберг'),
  (43, 'Райан Рейнольдс'),
  (44, 'Кен Сенг'),
  (45, 'Джанки Экс-Эл'),
  (46, 'Шон Хаворт'),
  (47, 'Джулиан Кларк'),
  (48, 'Морена Баккарин'),
  (49, 'Фрэнк Дарабонт'),
  (50, 'Стивен Кинг'),
  (51, 'Дэвид Валдес'),
  (52, 'Дэвид Тэттерсолл'),
  (53, 'Томас Ньюман'),
  (54, 'Теренс Марш'),
  (55, 'Уильям Крус'),
  (56, 'Керин Вагнер'),
  (57, 'Ричард Фрэнсис-Брюс')
);
  
INSERT INTO person2content VALUES (
  (1, 1, 'режиссер'),
  (2, 1, 'сценарист'),
  (3, 1, 'продюсер'),
  (4, 1, 'продюсер'),
  (5, 1, 'продюсер'),
  (6, 1, 'оператор'),
  (7, 1, 'композитор'),
  (8, 1, 'художник'),
  (9, 1, 'художник'),
  (10, 1, 'монтаж'),
  (11, 1, 'актер'),
  (12, 1, 'актер'),
  (13, 1, 'актер'),
  (14, 1, 'актер'),
  (15, 2, 'режиссер'),
  (16, 2, 'сценарист'),
  (17, 2, 'сценарист'),
  (18, 2, 'продюсер'),
  (19, 2, 'продюсер'),
  (20, 2, 'оператор'),
  (21, 2, 'композитор'),
  (22, 2, 'художник'),
  (23, 2, 'монтаж'),
  (24, 2, 'актер'),
  (25, 2, 'актер'),
  (26, 2, 'актер'),
  (27, 2, 'актер'),
  (28, 3, 'режиссер'),
  (28, 3, 'сценарист'),
  (29, 3, 'продюсер'),
  (28, 3, 'продюсер'),
  (30, 3, 'продюсер'),
  (31, 3, 'оператор'),
  (32, 3, 'композитор'),
  (33, 3, 'художник'),
  (29, 3, 'монтаж'),
  (34, 3, 'монтаж'),
  (35, 3, 'монтаж'),
  (36, 3, 'актер'),
  (37, 3, 'актер'),
  (38, 3, 'актер'),
  (39, 4, 'режиссер'),
  (40, 4, 'сценарист'),
  (41, 4, 'сценарист'),
  (42, 4, 'продюсер'),
  (43, 4, 'продюсер'),
  (44, 4, 'оператор'),
  (45, 4, 'композитор'),
  (46, 4, 'художник'),
  (47, 4, 'монтаж'),
  (43, 4, 'актер'),
  (48, 4, 'актер'),
  (49, 5, 'режиссер'),
  (49, 5, 'сценарист'),
  (50, 5, 'сценарист'),
  (49, 5, 'продюсер'),
  (51, 5, 'продюсер'),
  (52, 5, 'оператор'),
  (53, 5, 'композитор'),
  (54, 5, 'художник'),
  (55, 5, 'художник'),
  (56, 5, 'художник'),
  (57, 5, 'монтаж')
);

SELECT p.name, pc.person_role, 
       f.name, f.country, 
       f.fees, date_part('year', f.release_year)
FROM person2content pc
   JOIN films f
    ON pc.content_id = f.id
   JOIN persons p
    ON pc.person_id = p.id
ORDER BY p.name, f.name
;
